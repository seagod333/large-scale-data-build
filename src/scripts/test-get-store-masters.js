#!/usr/bin/env ts-node
'use strict';var __importDefault=this&&this['__importDefault']||function(_0x5bc34a){return _0x5bc34a&&_0x5bc34a['__esModule']?_0x5bc34a:{'default':_0x5bc34a};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const mongoose_1=__importDefault(require('mongoose')),logger_1=require('../utils/logger'),data_access_1=__importDefault(require('../min-repo/data-access')),get_store_masters_1=__importDefault(require('../min-repo/services/get-store-masters')),config_1=__importDefault(require('../config/config')),connectDatabase=async _0x1c14ff=>{try{const _0x5cf48c={'autoCreate':!![],'keepAlive':!![],'retryReads':!![]};mongoose_1['default']['set']('strictQuery',!![]);const _0xa1d3ef=await mongoose_1['default']['connect'](_0x1c14ff,_0x5cf48c);_0xa1d3ef&&logger_1['logger']['info']('MongoDB\x20connected');}catch(_0x3e2319){logger_1['logger']['error']('ConnectDatabase:\x20'+_0x3e2319['message']);throw _0x3e2319;}},testGetStoreMasters=async()=>{try{const _0xdce380=new Date();logger_1['logger']['info']('Starting\x20getStoreMasters\x20test\x20script...'),logger_1['logger']['info']('Connecting\x20to\x20database...');if(!config_1['default']['DATABASE'])throw new Error('DATABASE\x20environment\x20variable\x20is\x20not\x20set');await connectDatabase(config_1['default']['DATABASE']),logger_1['logger']['info']('Extracting\x20store\x20masters\x20data...');const _0x434421=await get_store_masters_1['default']['extractData']('2025-09-24'),_0x1bff42=new Date(),_0x4ff75e=((_0x1bff42['getTime']()-_0xdce380['getTime']())/0x3e8)['toFixed'](0x2);logger_1['logger']['info']('Extracted:\x20'+_0x434421['length']+'\x20store\x20records\x20(in\x20'+_0x4ff75e+'s)');if(_0x434421['length']>0x0){logger_1['logger']['info']('Saving\x20store\x20masters\x20data\x20to\x20database...');const _0x10a894=new Date(),_0x4c6fb0=await data_access_1['default']['storeMasterDB']['saveDatas'](_0x434421),_0x4733ee=new Date(),_0x5863ab=((_0x4733ee['getTime']()-_0x10a894['getTime']())/0x3e8)['toFixed'](0x2);logger_1['logger']['info']('Database\x20save\x20completed\x20in\x20'+_0x5863ab+'s:'),logger_1['logger']['info']('-\x20Total\x20processed:\x20'+_0x4c6fb0['totalProcessed']),logger_1['logger']['info']('-\x20Valid\x20records:\x20'+_0x4c6fb0['validRecords']),logger_1['logger']['info']('-\x20Successfully\x20saved:\x20'+_0x4c6fb0['savedStores']),logger_1['logger']['info']('-\x20Skipped\x20(duplicates/errors):\x20'+_0x4c6fb0['skippedStores']),logger_1['logger']['info']('-\x20Errors:\x20'+_0x4c6fb0['errors']);}else logger_1['logger']['warn']('No\x20store\x20masters\x20data\x20extracted\x20to\x20save');const _0x21cfd2=new Date(),_0x1189c3=((_0x21cfd2['getTime']()-_0xdce380['getTime']())/0x3e8)['toFixed'](0x2);logger_1['logger']['info']('Total\x20process\x20completed\x20in\x20'+_0x1189c3+'s');}catch(_0x10fab4){logger_1['logger']['error']('Failed\x20to\x20test\x20getStoreMasters:\x20'+_0x10fab4['message']),process['exit'](0x1);}finally{try{mongoose_1['default']['connection']['readyState']===0x1&&(await mongoose_1['default']['connection']['close'](),logger_1['logger']['info']('Database\x20connection\x20closed\x20successfully'));}catch(_0x455f27){logger_1['logger']['error']('Error\x20closing\x20database\x20connection:\x20'+_0x455f27['message']);}}};testGetStoreMasters();