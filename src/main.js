'use strict';var __importDefault=this&&this['__importDefault']||function(_0x1d225e){return _0x1d225e&&_0x1d225e['__esModule']?_0x1d225e:{'default':_0x1d225e};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const express_1=__importDefault(require('express')),cors_1=__importDefault(require('cors')),mongoose_1=__importDefault(require('mongoose')),body_parser_1=__importDefault(require('body-parser')),express_rate_limit_1=__importDefault(require('express-rate-limit')),express_fileupload_1=__importDefault(require('express-fileupload'));require('./subscribe/events');const Routes_1=require('./Routes'),logger_1=require('./utils/logger'),config_1=__importDefault(require('./config/config')),data_seeder_1=__importDefault(require('./services/data-seeder')),router=express_1['default']['Router'](),app=(0x0,express_1['default'])(),limiter=(0x0,express_rate_limit_1['default'])({'windowMs':0xf*0x3c*0x3e8,'max':0x4e20,'standardHeaders':!![],'legacyHeaders':![]}),connectDatabase=async _0x2bc8bd=>{try{const _0x779d3f={'autoCreate':!![],'keepAlive':!![],'retryReads':!![]};mongoose_1['default']['set']('strictQuery',!![]);const _0xa0b9a=await mongoose_1['default']['connect'](_0x2bc8bd,_0x779d3f);_0xa0b9a&&logger_1['logger']['info']('MongoDB\x20connected');}catch(_0x1e19e3){logger_1['logger']['error']('ConnectDatabase:\x20'+_0x1e19e3['message']);}};app['use'](body_parser_1['default']['urlencoded']({'extended':![]})),app['use'](body_parser_1['default']['json']()),app['use']((0x0,express_fileupload_1['default'])({'limits':{'fileSize':0x32*0x400*0x400}})),app['use'](express_1['default']['urlencoded']({'extended':!![]})),app['use']((0x0,cors_1['default'])({'origin':'*','methods':['POST','GET']})),app['use'](express_1['default']['json']()),app['use'](limiter),(0x0,Routes_1['Routes'])(router),app['use']('/api',router);const initializeApp=async()=>{try{await connectDatabase(config_1['default']['DATABASE']);const _0x70d102=new data_seeder_1['default']();await _0x70d102['seedAllMasterData'](),app['listen'](config_1['default']['PORT'],()=>{logger_1['logger']['info']('Server\x20listening\x20on\x20'+config_1['default']['PORT']+'\x20port');});}catch(_0x289778){logger_1['logger']['error']('Failed\x20to\x20initialize\x20app:\x20'+_0x289778['message']),process['exit'](0x1);}};initializeApp(),exports['default']=app;