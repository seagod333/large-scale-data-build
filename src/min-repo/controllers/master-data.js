'use strict';var __importDefault=this&&this['__importDefault']||function(_0x4806e5){return _0x4806e5&&_0x4806e5['__esModule']?_0x4806e5:{'default':_0x4806e5};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['MasterDataController']=void 0x0;const data_access_1=__importDefault(require('../data-access')),data_seeder_1=__importDefault(require('../../services/data-seeder')),logger_1=require('../../utils/logger');class MasterDataController{static async['getAreaMasters'](_0x2d2b39,_0xa55632){try{const _0x522e6f=await data_access_1['default']['areaMasterDB']['find']({'filter':{}});_0xa55632['json']({'success':!![],'data':_0x522e6f,'count':_0x522e6f['length']});}catch(_0x4aa578){logger_1['logger']['error']('Error\x20getting\x20area\x20masters:',_0x4aa578),_0xa55632['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20area\x20masters','error':_0x4aa578['message']});}}static async['getPrefectureModels'](_0xeee1d4,_0x90ad0c){try{const _0x3e1a74=await data_access_1['default']['prefectureModelDB']['find']({'filter':{}});_0x90ad0c['json']({'success':!![],'data':_0x3e1a74,'count':_0x3e1a74['length']});}catch(_0xe309ab){logger_1['logger']['error']('Error\x20getting\x20prefecture\x20models:',_0xe309ab),_0x90ad0c['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20prefecture\x20models','error':_0xe309ab['message']});}}static async['getPrefecturesByArea'](_0x3ba803,_0x56b042){try{const {areaId:_0x769fcf}=_0x3ba803['params'],_0x43521f=parseInt(_0x769fcf);if(isNaN(_0x43521f))return _0x56b042['status'](0x190)['json']({'success':![],'message':'Invalid\x20area\x20ID'});const _0x533d77=await data_access_1['default']['prefectureModelDB']['find']({'filter':{'a_ref_id':_0x43521f}});_0x56b042['json']({'success':!![],'data':_0x533d77,'count':_0x533d77['length']});}catch(_0x288d1a){logger_1['logger']['error']('Error\x20getting\x20prefectures\x20by\x20area:',_0x288d1a),_0x56b042['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20prefectures\x20by\x20area','error':_0x288d1a['message']});}}static async['searchPrefectures'](_0x379205,_0x3c3db8){try{const {q:_0x7038e2}=_0x379205['query'];if(!_0x7038e2||typeof _0x7038e2!=='string')return _0x3c3db8['status'](0x190)['json']({'success':![],'message':'Search\x20query\x20is\x20required'});const _0x53fe79=new RegExp(_0x7038e2,'i'),_0x44e405=await data_access_1['default']['prefectureModelDB']['find']({'filter':{'p_name':{'$regex':_0x53fe79}}});_0x3c3db8['json']({'success':!![],'data':_0x44e405,'count':_0x44e405['length']});}catch(_0x7b35bf){logger_1['logger']['error']('Error\x20searching\x20prefectures:',_0x7b35bf),_0x3c3db8['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20search\x20prefectures','error':_0x7b35bf['message']});}}static async['getMasterDataStats'](_0x3514d6,_0x69d78f){try{const _0x43edc3=await data_access_1['default']['areaMasterDB']['find']({'filter':{}}),_0x517c21=await data_access_1['default']['prefectureModelDB']['find']({'filter':{}}),_0x2829c4={'areaMasters':_0x43edc3['length'],'prefectureModels':_0x517c21['length'],'lastUpdated':new Date()};_0x69d78f['json']({'success':!![],'data':_0x2829c4});}catch(_0x383ab6){logger_1['logger']['error']('Error\x20getting\x20master\x20data\x20stats:',_0x383ab6),_0x69d78f['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20master\x20data\x20statistics','error':_0x383ab6['message']});}}static async['reseedMasterData'](_0x4044c4,_0x10b06a){try{const _0x8644f2=new data_seeder_1['default']();await _0x8644f2['seedAllMasterData'](),_0x10b06a['json']({'success':!![],'message':'Master\x20data\x20reseeded\x20successfully'});}catch(_0x452eec){logger_1['logger']['error']('Error\x20reseeding\x20master\x20data:',_0x452eec),_0x10b06a['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20reseed\x20master\x20data','error':_0x452eec['message']});}}static async['getAreaMasterForPrefecture'](_0x5a43d2,_0x109ed8){try{const {prefectureId:_0x50a7d4}=_0x5a43d2['params'],_0xf2d131=parseInt(_0x50a7d4);if(isNaN(_0xf2d131))return _0x109ed8['status'](0x190)['json']({'success':![],'message':'Invalid\x20prefecture\x20ID'});const _0x904fb5=await data_access_1['default']['prefectureModelDB']['findOne']({'filter':{'_id':_0xf2d131}});if(!_0x904fb5)return _0x109ed8['status'](0x194)['json']({'success':![],'message':'Prefecture\x20not\x20found'});const _0x23d659=await data_access_1['default']['areaMasterDB']['findOne']({'filter':{'_id':_0x904fb5['a_ref_id']}});if(!_0x23d659)return _0x109ed8['status'](0x194)['json']({'success':![],'message':'Area\x20master\x20not\x20found\x20for\x20this\x20prefecture'});_0x109ed8['json']({'success':!![],'data':_0x23d659});}catch(_0x2304d0){logger_1['logger']['error']('Error\x20getting\x20area\x20master\x20for\x20prefecture:',_0x2304d0),_0x109ed8['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20area\x20master\x20for\x20prefecture','error':_0x2304d0['message']});}}}exports['MasterDataController']=MasterDataController;