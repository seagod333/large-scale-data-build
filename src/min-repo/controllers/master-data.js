'use strict';var __importDefault=this&&this['__importDefault']||function(_0x1346cb){return _0x1346cb&&_0x1346cb['__esModule']?_0x1346cb:{'default':_0x1346cb};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['MasterDataController']=void 0x0;const data_access_1=__importDefault(require('../data-access')),data_seeder_1=__importDefault(require('../../services/data-seeder')),logger_1=require('../../utils/logger');class MasterDataController{static async['getAreaMasters'](_0x3cb662,_0x3e2c0a){try{const _0x186e54=await data_access_1['default']['areaMasterDB']['find']({'filter':{}});_0x3e2c0a['json']({'success':!![],'data':_0x186e54,'count':_0x186e54['length']});}catch(_0x375b29){logger_1['logger']['error']('Error\x20getting\x20area\x20masters:',_0x375b29),_0x3e2c0a['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20area\x20masters','error':_0x375b29['message']});}}static async['getPrefectureModels'](_0x1d3e95,_0x1080d9){try{const _0x1d40f6=await data_access_1['default']['prefectureModelDB']['find']({'filter':{}});_0x1080d9['json']({'success':!![],'data':_0x1d40f6,'count':_0x1d40f6['length']});}catch(_0x3a07e8){logger_1['logger']['error']('Error\x20getting\x20prefecture\x20models:',_0x3a07e8),_0x1080d9['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20prefecture\x20models','error':_0x3a07e8['message']});}}static async['getPrefecturesByArea'](_0x39fa9d,_0x5ae2d3){try{const {areaId:_0x5cc52c}=_0x39fa9d['params'],_0x425e9c=parseInt(_0x5cc52c);if(isNaN(_0x425e9c))return _0x5ae2d3['status'](0x190)['json']({'success':![],'message':'Invalid\x20area\x20ID'});const _0x51693d=await data_access_1['default']['prefectureModelDB']['find']({'filter':{'a_ref_id':_0x425e9c}});_0x5ae2d3['json']({'success':!![],'data':_0x51693d,'count':_0x51693d['length']});}catch(_0x485807){logger_1['logger']['error']('Error\x20getting\x20prefectures\x20by\x20area:',_0x485807),_0x5ae2d3['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20prefectures\x20by\x20area','error':_0x485807['message']});}}static async['searchPrefectures'](_0x2b059e,_0x2b8b3e){try{const {q:_0x12a6cd}=_0x2b059e['query'];if(!_0x12a6cd||typeof _0x12a6cd!=='string')return _0x2b8b3e['status'](0x190)['json']({'success':![],'message':'Search\x20query\x20is\x20required'});const _0x15e64c=new RegExp(_0x12a6cd,'i'),_0x152c6f=await data_access_1['default']['prefectureModelDB']['find']({'filter':{'p_name':{'$regex':_0x15e64c}}});_0x2b8b3e['json']({'success':!![],'data':_0x152c6f,'count':_0x152c6f['length']});}catch(_0x91abf2){logger_1['logger']['error']('Error\x20searching\x20prefectures:',_0x91abf2),_0x2b8b3e['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20search\x20prefectures','error':_0x91abf2['message']});}}static async['getMasterDataStats'](_0x513a65,_0x563ba8){try{const _0x470578=await data_access_1['default']['areaMasterDB']['find']({'filter':{}}),_0x2e9927=await data_access_1['default']['prefectureModelDB']['find']({'filter':{}}),_0x55aaff={'areaMasters':_0x470578['length'],'prefectureModels':_0x2e9927['length'],'lastUpdated':new Date()};_0x563ba8['json']({'success':!![],'data':_0x55aaff});}catch(_0x270908){logger_1['logger']['error']('Error\x20getting\x20master\x20data\x20stats:',_0x270908),_0x563ba8['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20master\x20data\x20statistics','error':_0x270908['message']});}}static async['reseedMasterData'](_0x3f4b9a,_0x19c6d5){try{const _0x52773d=new data_seeder_1['default']();await _0x52773d['seedAllMasterData'](),_0x19c6d5['json']({'success':!![],'message':'Master\x20data\x20reseeded\x20successfully'});}catch(_0x5725ce){logger_1['logger']['error']('Error\x20reseeding\x20master\x20data:',_0x5725ce),_0x19c6d5['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20reseed\x20master\x20data','error':_0x5725ce['message']});}}static async['getAreaMasterForPrefecture'](_0x11e745,_0xd1ba89){try{const {prefectureId:_0xfc9d22}=_0x11e745['params'],_0x57a26e=parseInt(_0xfc9d22);if(isNaN(_0x57a26e))return _0xd1ba89['status'](0x190)['json']({'success':![],'message':'Invalid\x20prefecture\x20ID'});const _0x2efa74=await data_access_1['default']['prefectureModelDB']['findOne']({'filter':{'_id':_0x57a26e}});if(!_0x2efa74)return _0xd1ba89['status'](0x194)['json']({'success':![],'message':'Prefecture\x20not\x20found'});const _0x31b878=await data_access_1['default']['areaMasterDB']['findOne']({'filter':{'_id':_0x2efa74['a_ref_id']}});if(!_0x31b878)return _0xd1ba89['status'](0x194)['json']({'success':![],'message':'Area\x20master\x20not\x20found\x20for\x20this\x20prefecture'});_0xd1ba89['json']({'success':!![],'data':_0x31b878});}catch(_0x389c74){logger_1['logger']['error']('Error\x20getting\x20area\x20master\x20for\x20prefecture:',_0x389c74),_0xd1ba89['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20area\x20master\x20for\x20prefecture','error':_0x389c74['message']});}}}exports['MasterDataController']=MasterDataController;