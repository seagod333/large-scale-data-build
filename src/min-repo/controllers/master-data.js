'use strict';var __importDefault=this&&this['__importDefault']||function(_0x1bbf25){return _0x1bbf25&&_0x1bbf25['__esModule']?_0x1bbf25:{'default':_0x1bbf25};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['MasterDataController']=void 0x0;const data_access_1=__importDefault(require('../data-access')),data_seeder_1=__importDefault(require('../../services/data-seeder')),logger_1=require('../../utils/logger');class MasterDataController{static async['getAreaMasters'](_0x505b80,_0x26929b){try{const _0x4573e2=await data_access_1['default']['areaMasterDB']['find']({'filter':{}});_0x26929b['json']({'success':!![],'data':_0x4573e2,'count':_0x4573e2['length']});}catch(_0x52e370){logger_1['logger']['error']('Error\x20getting\x20area\x20masters:',_0x52e370),_0x26929b['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20area\x20masters','error':_0x52e370['message']});}}static async['getPrefectureModels'](_0xb8e1a3,_0x5c96b3){try{const _0x513fa3=await data_access_1['default']['prefectureModelDB']['find']({'filter':{}});_0x5c96b3['json']({'success':!![],'data':_0x513fa3,'count':_0x513fa3['length']});}catch(_0x1892bb){logger_1['logger']['error']('Error\x20getting\x20prefecture\x20models:',_0x1892bb),_0x5c96b3['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20prefecture\x20models','error':_0x1892bb['message']});}}static async['getPrefecturesByArea'](_0x5acbe7,_0x4f81e1){try{const {areaId:_0x2de56f}=_0x5acbe7['params'],_0x493032=parseInt(_0x2de56f);if(isNaN(_0x493032))return _0x4f81e1['status'](0x190)['json']({'success':![],'message':'Invalid\x20area\x20ID'});const _0x1966fa=await data_access_1['default']['prefectureModelDB']['find']({'filter':{'a_ref_id':_0x493032}});_0x4f81e1['json']({'success':!![],'data':_0x1966fa,'count':_0x1966fa['length']});}catch(_0x5c7a18){logger_1['logger']['error']('Error\x20getting\x20prefectures\x20by\x20area:',_0x5c7a18),_0x4f81e1['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20prefectures\x20by\x20area','error':_0x5c7a18['message']});}}static async['searchPrefectures'](_0x31f5f1,_0x179804){try{const {q:_0x3ee605}=_0x31f5f1['query'];if(!_0x3ee605||typeof _0x3ee605!=='string')return _0x179804['status'](0x190)['json']({'success':![],'message':'Search\x20query\x20is\x20required'});const _0x13d9b9=new RegExp(_0x3ee605,'i'),_0x550192=await data_access_1['default']['prefectureModelDB']['find']({'filter':{'p_name':{'$regex':_0x13d9b9}}});_0x179804['json']({'success':!![],'data':_0x550192,'count':_0x550192['length']});}catch(_0x10fc3e){logger_1['logger']['error']('Error\x20searching\x20prefectures:',_0x10fc3e),_0x179804['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20search\x20prefectures','error':_0x10fc3e['message']});}}static async['getMasterDataStats'](_0x3056d8,_0x3799c5){try{const _0x29cd84=await data_access_1['default']['areaMasterDB']['find']({'filter':{}}),_0xc00c12=await data_access_1['default']['prefectureModelDB']['find']({'filter':{}}),_0x4c81c9={'areaMasters':_0x29cd84['length'],'prefectureModels':_0xc00c12['length'],'lastUpdated':new Date()};_0x3799c5['json']({'success':!![],'data':_0x4c81c9});}catch(_0x4624bb){logger_1['logger']['error']('Error\x20getting\x20master\x20data\x20stats:',_0x4624bb),_0x3799c5['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20master\x20data\x20statistics','error':_0x4624bb['message']});}}static async['reseedMasterData'](_0x4db28a,_0x46b955){try{const _0x2eee9c=new data_seeder_1['default']();await _0x2eee9c['seedAllMasterData'](),_0x46b955['json']({'success':!![],'message':'Master\x20data\x20reseeded\x20successfully'});}catch(_0x3c79b9){logger_1['logger']['error']('Error\x20reseeding\x20master\x20data:',_0x3c79b9),_0x46b955['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20reseed\x20master\x20data','error':_0x3c79b9['message']});}}static async['getAreaMasterForPrefecture'](_0x3ec98a,_0x42645d){try{const {prefectureId:_0x5f2750}=_0x3ec98a['params'],_0x4d8e3b=parseInt(_0x5f2750);if(isNaN(_0x4d8e3b))return _0x42645d['status'](0x190)['json']({'success':![],'message':'Invalid\x20prefecture\x20ID'});const _0x3700c3=await data_access_1['default']['prefectureModelDB']['findOne']({'filter':{'_id':_0x4d8e3b}});if(!_0x3700c3)return _0x42645d['status'](0x194)['json']({'success':![],'message':'Prefecture\x20not\x20found'});const _0x5b5ea1=await data_access_1['default']['areaMasterDB']['findOne']({'filter':{'_id':_0x3700c3['a_ref_id']}});if(!_0x5b5ea1)return _0x42645d['status'](0x194)['json']({'success':![],'message':'Area\x20master\x20not\x20found\x20for\x20this\x20prefecture'});_0x42645d['json']({'success':!![],'data':_0x5b5ea1});}catch(_0x40047a){logger_1['logger']['error']('Error\x20getting\x20area\x20master\x20for\x20prefecture:',_0x40047a),_0x42645d['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20area\x20master\x20for\x20prefecture','error':_0x40047a['message']});}}}exports['MasterDataController']=MasterDataController;