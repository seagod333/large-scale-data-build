'use strict';var __importDefault=this&&this['__importDefault']||function(_0x5525bc){return _0x5525bc&&_0x5525bc['__esModule']?_0x5525bc:{'default':_0x5525bc};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['MasterDataController']=void 0x0;const data_access_1=__importDefault(require('../data-access')),data_seeder_1=__importDefault(require('../../services/data-seeder')),logger_1=require('../../utils/logger');class MasterDataController{static async['getAreaMasters'](_0x53b307,_0x3a061d){try{const _0x15ee6f=await data_access_1['default']['areaMasterDB']['find']({'filter':{}});_0x3a061d['json']({'success':!![],'data':_0x15ee6f,'count':_0x15ee6f['length']});}catch(_0x3b8d1b){logger_1['logger']['error']('Error\x20getting\x20area\x20masters:',_0x3b8d1b),_0x3a061d['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20area\x20masters','error':_0x3b8d1b['message']});}}static async['getPrefectureModels'](_0x2326ff,_0x189d24){try{const _0x5b4dbd=await data_access_1['default']['prefectureModelDB']['find']({'filter':{}});_0x189d24['json']({'success':!![],'data':_0x5b4dbd,'count':_0x5b4dbd['length']});}catch(_0x3c98ab){logger_1['logger']['error']('Error\x20getting\x20prefecture\x20models:',_0x3c98ab),_0x189d24['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20prefecture\x20models','error':_0x3c98ab['message']});}}static async['getPrefecturesByArea'](_0x47fef6,_0x55bf85){try{const {areaId:_0x424b18}=_0x47fef6['params'],_0x3bd3b6=parseInt(_0x424b18);if(isNaN(_0x3bd3b6))return _0x55bf85['status'](0x190)['json']({'success':![],'message':'Invalid\x20area\x20ID'});const _0x40862d=await data_access_1['default']['prefectureModelDB']['find']({'filter':{'a_ref_id':_0x3bd3b6}});_0x55bf85['json']({'success':!![],'data':_0x40862d,'count':_0x40862d['length']});}catch(_0x311bcf){logger_1['logger']['error']('Error\x20getting\x20prefectures\x20by\x20area:',_0x311bcf),_0x55bf85['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20prefectures\x20by\x20area','error':_0x311bcf['message']});}}static async['searchPrefectures'](_0x1f1e74,_0x26e5b4){try{const {q:_0x35b947}=_0x1f1e74['query'];if(!_0x35b947||typeof _0x35b947!=='string')return _0x26e5b4['status'](0x190)['json']({'success':![],'message':'Search\x20query\x20is\x20required'});const _0x312e57=new RegExp(_0x35b947,'i'),_0x28ae39=await data_access_1['default']['prefectureModelDB']['find']({'filter':{'p_name':{'$regex':_0x312e57}}});_0x26e5b4['json']({'success':!![],'data':_0x28ae39,'count':_0x28ae39['length']});}catch(_0x463ccb){logger_1['logger']['error']('Error\x20searching\x20prefectures:',_0x463ccb),_0x26e5b4['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20search\x20prefectures','error':_0x463ccb['message']});}}static async['getMasterDataStats'](_0xd4c023,_0x2f7b0c){try{const _0x2d3fcb=await data_access_1['default']['areaMasterDB']['find']({'filter':{}}),_0x36a9b1=await data_access_1['default']['prefectureModelDB']['find']({'filter':{}}),_0x434c99={'areaMasters':_0x2d3fcb['length'],'prefectureModels':_0x36a9b1['length'],'lastUpdated':new Date()};_0x2f7b0c['json']({'success':!![],'data':_0x434c99});}catch(_0x1bc0f0){logger_1['logger']['error']('Error\x20getting\x20master\x20data\x20stats:',_0x1bc0f0),_0x2f7b0c['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20master\x20data\x20statistics','error':_0x1bc0f0['message']});}}static async['reseedMasterData'](_0x333256,_0x315e23){try{const _0x166343=new data_seeder_1['default']();await _0x166343['seedAllMasterData'](),_0x315e23['json']({'success':!![],'message':'Master\x20data\x20reseeded\x20successfully'});}catch(_0x580836){logger_1['logger']['error']('Error\x20reseeding\x20master\x20data:',_0x580836),_0x315e23['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20reseed\x20master\x20data','error':_0x580836['message']});}}static async['getAreaMasterForPrefecture'](_0xaaf7e8,_0x51a24e){try{const {prefectureId:_0x3d9291}=_0xaaf7e8['params'],_0x3316c3=parseInt(_0x3d9291);if(isNaN(_0x3316c3))return _0x51a24e['status'](0x190)['json']({'success':![],'message':'Invalid\x20prefecture\x20ID'});const _0x275149=await data_access_1['default']['prefectureModelDB']['findOne']({'filter':{'_id':_0x3316c3}});if(!_0x275149)return _0x51a24e['status'](0x194)['json']({'success':![],'message':'Prefecture\x20not\x20found'});const _0x5bc4d5=await data_access_1['default']['areaMasterDB']['findOne']({'filter':{'_id':_0x275149['a_ref_id']}});if(!_0x5bc4d5)return _0x51a24e['status'](0x194)['json']({'success':![],'message':'Area\x20master\x20not\x20found\x20for\x20this\x20prefecture'});_0x51a24e['json']({'success':!![],'data':_0x5bc4d5});}catch(_0x49a415){logger_1['logger']['error']('Error\x20getting\x20area\x20master\x20for\x20prefecture:',_0x49a415),_0x51a24e['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20area\x20master\x20for\x20prefecture','error':_0x49a415['message']});}}}exports['MasterDataController']=MasterDataController;