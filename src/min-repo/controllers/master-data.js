'use strict';var __importDefault=this&&this['__importDefault']||function(_0x3db5f8){return _0x3db5f8&&_0x3db5f8['__esModule']?_0x3db5f8:{'default':_0x3db5f8};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['MasterDataController']=void 0x0;const data_access_1=__importDefault(require('../data-access')),data_seeder_1=__importDefault(require('../../services/data-seeder')),logger_1=require('../../utils/logger');class MasterDataController{static async['getAreaMasters'](_0x4aedb9,_0x1bddd1){try{const _0x2d9375=await data_access_1['default']['areaMasterDB']['find']({'filter':{}});_0x1bddd1['json']({'success':!![],'data':_0x2d9375,'count':_0x2d9375['length']});}catch(_0x3a5594){logger_1['logger']['error']('Error\x20getting\x20area\x20masters:',_0x3a5594),_0x1bddd1['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20area\x20masters','error':_0x3a5594['message']});}}static async['getPrefectureModels'](_0x1b453d,_0x414d5a){try{const _0x10a382=await data_access_1['default']['prefectureModelDB']['find']({'filter':{}});_0x414d5a['json']({'success':!![],'data':_0x10a382,'count':_0x10a382['length']});}catch(_0x31d666){logger_1['logger']['error']('Error\x20getting\x20prefecture\x20models:',_0x31d666),_0x414d5a['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20prefecture\x20models','error':_0x31d666['message']});}}static async['getPrefecturesByArea'](_0x1a23bd,_0x1bde8a){try{const {areaId:_0x20a23c}=_0x1a23bd['params'],_0x44e57a=parseInt(_0x20a23c);if(isNaN(_0x44e57a))return _0x1bde8a['status'](0x190)['json']({'success':![],'message':'Invalid\x20area\x20ID'});const _0x2d4bbc=await data_access_1['default']['prefectureModelDB']['find']({'filter':{'a_ref_id':_0x44e57a}});_0x1bde8a['json']({'success':!![],'data':_0x2d4bbc,'count':_0x2d4bbc['length']});}catch(_0x136d93){logger_1['logger']['error']('Error\x20getting\x20prefectures\x20by\x20area:',_0x136d93),_0x1bde8a['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20prefectures\x20by\x20area','error':_0x136d93['message']});}}static async['searchPrefectures'](_0x1e2629,_0x3035b2){try{const {q:_0x363f6e}=_0x1e2629['query'];if(!_0x363f6e||typeof _0x363f6e!=='string')return _0x3035b2['status'](0x190)['json']({'success':![],'message':'Search\x20query\x20is\x20required'});const _0x25e847=new RegExp(_0x363f6e,'i'),_0xa2be8f=await data_access_1['default']['prefectureModelDB']['find']({'filter':{'p_name':{'$regex':_0x25e847}}});_0x3035b2['json']({'success':!![],'data':_0xa2be8f,'count':_0xa2be8f['length']});}catch(_0x1c540e){logger_1['logger']['error']('Error\x20searching\x20prefectures:',_0x1c540e),_0x3035b2['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20search\x20prefectures','error':_0x1c540e['message']});}}static async['getMasterDataStats'](_0x18bb48,_0x48aff4){try{const _0x29b934=await data_access_1['default']['areaMasterDB']['find']({'filter':{}}),_0x127b14=await data_access_1['default']['prefectureModelDB']['find']({'filter':{}}),_0x4d9f91={'areaMasters':_0x29b934['length'],'prefectureModels':_0x127b14['length'],'lastUpdated':new Date()};_0x48aff4['json']({'success':!![],'data':_0x4d9f91});}catch(_0x21214d){logger_1['logger']['error']('Error\x20getting\x20master\x20data\x20stats:',_0x21214d),_0x48aff4['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20master\x20data\x20statistics','error':_0x21214d['message']});}}static async['reseedMasterData'](_0x4b3e90,_0x130f69){try{const _0x50fbbb=new data_seeder_1['default']();await _0x50fbbb['seedAllMasterData'](),_0x130f69['json']({'success':!![],'message':'Master\x20data\x20reseeded\x20successfully'});}catch(_0x3fc574){logger_1['logger']['error']('Error\x20reseeding\x20master\x20data:',_0x3fc574),_0x130f69['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20reseed\x20master\x20data','error':_0x3fc574['message']});}}static async['getAreaMasterForPrefecture'](_0x5e7bcc,_0x308856){try{const {prefectureId:_0x1005fc}=_0x5e7bcc['params'],_0x49761c=parseInt(_0x1005fc);if(isNaN(_0x49761c))return _0x308856['status'](0x190)['json']({'success':![],'message':'Invalid\x20prefecture\x20ID'});const _0x10f939=await data_access_1['default']['prefectureModelDB']['findOne']({'filter':{'_id':_0x49761c}});if(!_0x10f939)return _0x308856['status'](0x194)['json']({'success':![],'message':'Prefecture\x20not\x20found'});const _0x4bb329=await data_access_1['default']['areaMasterDB']['findOne']({'filter':{'_id':_0x10f939['a_ref_id']}});if(!_0x4bb329)return _0x308856['status'](0x194)['json']({'success':![],'message':'Area\x20master\x20not\x20found\x20for\x20this\x20prefecture'});_0x308856['json']({'success':!![],'data':_0x4bb329});}catch(_0x5decb4){logger_1['logger']['error']('Error\x20getting\x20area\x20master\x20for\x20prefecture:',_0x5decb4),_0x308856['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20get\x20area\x20master\x20for\x20prefecture','error':_0x5decb4['message']});}}}exports['MasterDataController']=MasterDataController;