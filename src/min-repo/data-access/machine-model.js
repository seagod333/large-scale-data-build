'use strict';var __importDefault=this&&this['__importDefault']||function(_0x24232c){return _0x24232c&&_0x24232c['__esModule']?_0x24232c:{'default':_0x24232c};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const models_1=__importDefault(require('../models')),customError_1=require('../../@types/customError'),logger_1=require('../../utils/logger'),database_1=require('../../services/database'),machineModelDB={'create':async _0x758baf=>{const _0x367403=new models_1['default']['machineModel'](_0x758baf),_0x464557=await _0x367403['save']();if(!_0x464557)throw new customError_1['DatabaseError']('machineModelDB\x20Database\x20Error');return _0x464557;},'findOne':async({filter:_0xd39f1c})=>{return models_1['default']['machineModel']['findOne'](_0xd39f1c);},'find':async({filter:_0x15b03d})=>{return models_1['default']['machineModel']['find'](_0x15b03d);},'update':async({filter:_0x93cea4,update:_0x3369a3})=>{return models_1['default']['machineModel']['findOneAndUpdate'](_0x93cea4,_0x3369a3);},'remove':async({filter:_0x334a47})=>{const _0x19eb64=await models_1['default']['machineModel']['deleteOne'](_0x334a47);return{'found':_0x19eb64['n'],'deleted':_0x19eb64['deletedCount']};},'saveDatas':async _0x3ad009=>{try{if(!_0x3ad009||_0x3ad009['length']===0x0)throw new customError_1['DatabaseError']('No\x20data\x20provided');logger_1['logger']['info']('Processing\x20'+_0x3ad009['length']+'\x20machine\x20model\x20records...');const _0x13d907=new Set(),_0x4fc67b=await models_1['default']['machineModel']['find']({},{'machine_name':0x1,'_id':0x0});_0x4fc67b['forEach'](_0x423b91=>{if(_0x423b91?.['machine_name'])_0x13d907['add'](_0x423b91['machine_name']);});let _0x309bcf=await(0x0,database_1['getLastIndex'])(models_1['default']['machineModel']);const _0x46a1b3=[],_0x1c4575=[],_0x5e6fe4=new Set();let _0x303219=0x0;for(const _0x4579bb of _0x3ad009){const _0x4e4722=(_0x4579bb?.['machine_name']||'')['trim']();if(!_0x4e4722){_0x1c4575['push']({'machine_name':'','reason':'Empty\x20machine_name'});continue;}if(_0x13d907['has'](_0x4e4722)){_0x1c4575['push']({'machine_name':_0x4e4722,'reason':'Model\x20already\x20exists'});continue;}if(_0x5e6fe4['has'](_0x4e4722)){_0x1c4575['push']({'machine_name':_0x4e4722,'reason':'Duplicate\x20in\x20input'});continue;}_0x46a1b3['push']({'_id':_0x309bcf++,'machine_name':_0x4e4722,'is_visible':0x1}),_0x5e6fe4['add'](_0x4e4722),_0x303219++;}const _0xc8b62f=0x3e8,_0x395ac7=[];for(let _0x434d5f=0x0;_0x434d5f<_0x46a1b3['length'];_0x434d5f+=_0xc8b62f){_0x395ac7['push'](_0x46a1b3['slice'](_0x434d5f,_0x434d5f+_0xc8b62f));}let _0x25ceba=0x0,_0x5df05b=0x0;const _0x3918d7=[];for(let _0x55cdf7=0x0;_0x55cdf7<_0x395ac7['length'];_0x55cdf7++){const _0x272e67=_0x395ac7[_0x55cdf7];try{const _0x562c6d=await models_1['default']['machineModel']['insertMany'](_0x272e67,{'ordered':![],'rawResult':![]});_0x25ceba+=_0x562c6d['length'];}catch(_0x359a94){_0x359a94?.['writeErrors']?(_0x5df05b+=_0x359a94['writeErrors']['length'],_0x359a94['writeErrors']['forEach'](_0x29a397=>{_0x3918d7['push']({'batch':_0x55cdf7+0x1,'error':_0x29a397?.['errmsg'],'document':_0x29a397?.['op']});})):(_0x5df05b+=_0x272e67['length'],_0x3918d7['push']({'batch':_0x55cdf7+0x1,'error':_0x359a94?.['message'],'document':'entire\x20batch'}));}}return logger_1['logger']['info']('Bulk\x20operation\x20completed:\x20'+_0x25ceba+'\x20inserted,\x20'+_0x5df05b+'\x20errors'),{'success':!![],'totalProcessed':_0x3ad009['length'],'validRecords':_0x303219,'savedModels':_0x25ceba,'skippedModels':_0x1c4575['length'],'errors':_0x5df05b,'errorDetails':_0x3918d7['slice'](0x0,0xa),'skipped':_0x1c4575['slice'](0x0,0x64)};}catch(_0xa476ed){throw new customError_1['DatabaseError']('saveDatas\x20Error:\x20'+_0xa476ed?.['message']);}}};exports['default']=machineModelDB;