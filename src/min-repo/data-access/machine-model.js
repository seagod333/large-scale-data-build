'use strict';var __importDefault=this&&this['__importDefault']||function(_0x40926b){return _0x40926b&&_0x40926b['__esModule']?_0x40926b:{'default':_0x40926b};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const models_1=__importDefault(require('../models')),customError_1=require('../../@types/customError'),logger_1=require('../../utils/logger'),database_1=require('../../services/database'),machineModelDB={'create':async _0xcd9d8a=>{const _0x250e18=new models_1['default']['machineModel'](_0xcd9d8a),_0x1d539d=await _0x250e18['save']();if(!_0x1d539d)throw new customError_1['DatabaseError']('machineModelDB\x20Database\x20Error');return _0x1d539d;},'findOne':async({filter:_0x208280})=>{return models_1['default']['machineModel']['findOne'](_0x208280);},'find':async({filter:_0x3fbe31})=>{return models_1['default']['machineModel']['find'](_0x3fbe31);},'update':async({filter:_0x178ed2,update:_0x125cf3})=>{return models_1['default']['machineModel']['findOneAndUpdate'](_0x178ed2,_0x125cf3);},'remove':async({filter:_0x1bd40c})=>{const _0x80b1ab=await models_1['default']['machineModel']['deleteOne'](_0x1bd40c);return{'found':_0x80b1ab['n'],'deleted':_0x80b1ab['deletedCount']};},'saveDatas':async _0x46bc49=>{try{if(!_0x46bc49||_0x46bc49['length']===0x0)throw new customError_1['DatabaseError']('No\x20data\x20provided');logger_1['logger']['info']('Processing\x20'+_0x46bc49['length']+'\x20machine\x20model\x20records...');const _0xff7945=new Set(),_0x869adb=await models_1['default']['machineModel']['find']({},{'machine_name':0x1,'_id':0x0});_0x869adb['forEach'](_0x3a1918=>{if(_0x3a1918?.['machine_name'])_0xff7945['add'](_0x3a1918['machine_name']);});let _0x151248=await(0x0,database_1['getLastIndex'])(models_1['default']['machineModel']);const _0x5efbf1=[],_0x501348=[],_0x803e8f=new Set();let _0x3450c1=0x0;for(const _0x222864 of _0x46bc49){const _0x23c4dc=(_0x222864?.['machine_name']||'')['trim']();if(!_0x23c4dc){_0x501348['push']({'machine_name':'','reason':'Empty\x20machine_name'});continue;}if(_0xff7945['has'](_0x23c4dc)){_0x501348['push']({'machine_name':_0x23c4dc,'reason':'Model\x20already\x20exists'});continue;}if(_0x803e8f['has'](_0x23c4dc)){_0x501348['push']({'machine_name':_0x23c4dc,'reason':'Duplicate\x20in\x20input'});continue;}_0x5efbf1['push']({'_id':_0x151248++,'machine_name':_0x23c4dc,'is_visible':0x1}),_0x803e8f['add'](_0x23c4dc),_0x3450c1++;}const _0x4adeb0=0x3e8,_0x7cbf2a=[];for(let _0xa63444=0x0;_0xa63444<_0x5efbf1['length'];_0xa63444+=_0x4adeb0){_0x7cbf2a['push'](_0x5efbf1['slice'](_0xa63444,_0xa63444+_0x4adeb0));}let _0x20766d=0x0,_0x3a9f44=0x0;const _0x302668=[];for(let _0x49c23d=0x0;_0x49c23d<_0x7cbf2a['length'];_0x49c23d++){const _0x18ad4e=_0x7cbf2a[_0x49c23d];try{const _0x39041e=await models_1['default']['machineModel']['insertMany'](_0x18ad4e,{'ordered':![],'rawResult':![]});_0x20766d+=_0x39041e['length'];}catch(_0x53c4af){_0x53c4af?.['writeErrors']?(_0x3a9f44+=_0x53c4af['writeErrors']['length'],_0x53c4af['writeErrors']['forEach'](_0x4047ca=>{_0x302668['push']({'batch':_0x49c23d+0x1,'error':_0x4047ca?.['errmsg'],'document':_0x4047ca?.['op']});})):(_0x3a9f44+=_0x18ad4e['length'],_0x302668['push']({'batch':_0x49c23d+0x1,'error':_0x53c4af?.['message'],'document':'entire\x20batch'}));}}return logger_1['logger']['info']('Bulk\x20operation\x20completed:\x20'+_0x20766d+'\x20inserted,\x20'+_0x3a9f44+'\x20errors'),{'success':!![],'totalProcessed':_0x46bc49['length'],'validRecords':_0x3450c1,'savedModels':_0x20766d,'skippedModels':_0x501348['length'],'errors':_0x3a9f44,'errorDetails':_0x302668['slice'](0x0,0xa),'skipped':_0x501348['slice'](0x0,0x64)};}catch(_0x3e69c9){throw new customError_1['DatabaseError']('saveDatas\x20Error:\x20'+_0x3e69c9?.['message']);}}};exports['default']=machineModelDB;