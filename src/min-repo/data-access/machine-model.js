'use strict';var __importDefault=this&&this['__importDefault']||function(_0x57f26b){return _0x57f26b&&_0x57f26b['__esModule']?_0x57f26b:{'default':_0x57f26b};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const models_1=__importDefault(require('../models')),customError_1=require('../../@types/customError'),logger_1=require('../../utils/logger'),database_1=require('../../services/database'),machineModelDB={'create':async _0x4f1439=>{const _0x11401b=new models_1['default']['machineModel'](_0x4f1439),_0x1d2e50=await _0x11401b['save']();if(!_0x1d2e50)throw new customError_1['DatabaseError']('machineModelDB\x20Database\x20Error');return _0x1d2e50;},'findOne':async({filter:_0x18cc13})=>{return models_1['default']['machineModel']['findOne'](_0x18cc13);},'find':async({filter:_0x304d96})=>{return models_1['default']['machineModel']['find'](_0x304d96);},'update':async({filter:_0xdd6cae,update:_0x49aaa3})=>{return models_1['default']['machineModel']['findOneAndUpdate'](_0xdd6cae,_0x49aaa3);},'remove':async({filter:_0x2f05b5})=>{const _0x22ba55=await models_1['default']['machineModel']['deleteOne'](_0x2f05b5);return{'found':_0x22ba55['n'],'deleted':_0x22ba55['deletedCount']};},'saveDatas':async _0x549060=>{try{if(!_0x549060||_0x549060['length']===0x0)throw new customError_1['DatabaseError']('No\x20data\x20provided');logger_1['logger']['info']('Processing\x20'+_0x549060['length']+'\x20machine\x20model\x20records...');const _0x4060ec=new Set(),_0x1e16b9=await models_1['default']['machineModel']['find']({},{'machine_name':0x1,'_id':0x0});_0x1e16b9['forEach'](_0x5bf09a=>{if(_0x5bf09a?.['machine_name'])_0x4060ec['add'](_0x5bf09a['machine_name']);});let _0x289bf3=await(0x0,database_1['getLastIndex'])(models_1['default']['machineModel']);const _0xd4c735=[],_0x42eff3=[],_0x2f9764=new Set();let _0x1d88f7=0x0;for(const _0x5ef4c4 of _0x549060){const _0x14d98e=(_0x5ef4c4?.['machine_name']||'')['trim']();if(!_0x14d98e){_0x42eff3['push']({'machine_name':'','reason':'Empty\x20machine_name'});continue;}if(_0x4060ec['has'](_0x14d98e)){_0x42eff3['push']({'machine_name':_0x14d98e,'reason':'Model\x20already\x20exists'});continue;}if(_0x2f9764['has'](_0x14d98e)){_0x42eff3['push']({'machine_name':_0x14d98e,'reason':'Duplicate\x20in\x20input'});continue;}_0xd4c735['push']({'_id':_0x289bf3++,'machine_name':_0x14d98e,'is_visible':0x1}),_0x2f9764['add'](_0x14d98e),_0x1d88f7++;}const _0x22e069=0x3e8,_0x3390fc=[];for(let _0x1fa492=0x0;_0x1fa492<_0xd4c735['length'];_0x1fa492+=_0x22e069){_0x3390fc['push'](_0xd4c735['slice'](_0x1fa492,_0x1fa492+_0x22e069));}let _0x1609ae=0x0,_0x12fbdf=0x0;const _0x8d75ad=[];for(let _0x1a8f81=0x0;_0x1a8f81<_0x3390fc['length'];_0x1a8f81++){const _0x4ece0f=_0x3390fc[_0x1a8f81];try{const _0x4214c8=await models_1['default']['machineModel']['insertMany'](_0x4ece0f,{'ordered':![],'rawResult':![]});_0x1609ae+=_0x4214c8['length'];}catch(_0x59de7d){_0x59de7d?.['writeErrors']?(_0x12fbdf+=_0x59de7d['writeErrors']['length'],_0x59de7d['writeErrors']['forEach'](_0x156072=>{_0x8d75ad['push']({'batch':_0x1a8f81+0x1,'error':_0x156072?.['errmsg'],'document':_0x156072?.['op']});})):(_0x12fbdf+=_0x4ece0f['length'],_0x8d75ad['push']({'batch':_0x1a8f81+0x1,'error':_0x59de7d?.['message'],'document':'entire\x20batch'}));}}return logger_1['logger']['info']('Bulk\x20operation\x20completed:\x20'+_0x1609ae+'\x20inserted,\x20'+_0x12fbdf+'\x20errors'),{'success':!![],'totalProcessed':_0x549060['length'],'validRecords':_0x1d88f7,'savedModels':_0x1609ae,'skippedModels':_0x42eff3['length'],'errors':_0x12fbdf,'errorDetails':_0x8d75ad['slice'](0x0,0xa),'skipped':_0x42eff3['slice'](0x0,0x64)};}catch(_0x2a4f83){throw new customError_1['DatabaseError']('saveDatas\x20Error:\x20'+_0x2a4f83?.['message']);}}};exports['default']=machineModelDB;