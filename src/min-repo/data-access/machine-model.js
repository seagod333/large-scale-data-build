'use strict';var __importDefault=this&&this['__importDefault']||function(_0x501ad9){return _0x501ad9&&_0x501ad9['__esModule']?_0x501ad9:{'default':_0x501ad9};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const models_1=__importDefault(require('../models')),customError_1=require('../../@types/customError'),logger_1=require('../../utils/logger'),database_1=require('../../services/database'),machineModelDB={'create':async _0x433020=>{const _0x25474e=new models_1['default']['machineModel'](_0x433020),_0x2d01b3=await _0x25474e['save']();if(!_0x2d01b3)throw new customError_1['DatabaseError']('machineModelDB\x20Database\x20Error');return _0x2d01b3;},'findOne':async({filter:_0x35051c})=>{return models_1['default']['machineModel']['findOne'](_0x35051c);},'find':async({filter:_0x49cb5f})=>{return models_1['default']['machineModel']['find'](_0x49cb5f);},'update':async({filter:_0x43c5c4,update:_0x5acd23})=>{return models_1['default']['machineModel']['findOneAndUpdate'](_0x43c5c4,_0x5acd23);},'remove':async({filter:_0x3f6498})=>{const _0x305f69=await models_1['default']['machineModel']['deleteOne'](_0x3f6498);return{'found':_0x305f69['n'],'deleted':_0x305f69['deletedCount']};},'saveDatas':async _0x2481dd=>{try{if(!_0x2481dd||_0x2481dd['length']===0x0)throw new customError_1['DatabaseError']('No\x20data\x20provided');logger_1['logger']['info']('Processing\x20'+_0x2481dd['length']+'\x20machine\x20model\x20records...');const _0x4aeb26=new Set(),_0x350f2f=await models_1['default']['machineModel']['find']({},{'machine_name':0x1,'_id':0x0});_0x350f2f['forEach'](_0x5da659=>{if(_0x5da659?.['machine_name'])_0x4aeb26['add'](_0x5da659['machine_name']);});let _0x1e73a5=await(0x0,database_1['getLastIndex'])(models_1['default']['machineModel']);const _0xfa7e7d=[],_0x558546=[],_0x3df15d=new Set();let _0x268dec=0x0;for(const _0x166255 of _0x2481dd){const _0x42bc4c=(_0x166255?.['machine_name']||'')['trim']();if(!_0x42bc4c){_0x558546['push']({'machine_name':'','reason':'Empty\x20machine_name'});continue;}if(_0x4aeb26['has'](_0x42bc4c)){_0x558546['push']({'machine_name':_0x42bc4c,'reason':'Model\x20already\x20exists'});continue;}if(_0x3df15d['has'](_0x42bc4c)){_0x558546['push']({'machine_name':_0x42bc4c,'reason':'Duplicate\x20in\x20input'});continue;}_0xfa7e7d['push']({'_id':_0x1e73a5++,'machine_name':_0x42bc4c,'is_visible':0x1}),_0x3df15d['add'](_0x42bc4c),_0x268dec++;}const _0x4a5738=0x3e8,_0x1044ee=[];for(let _0x19a8ac=0x0;_0x19a8ac<_0xfa7e7d['length'];_0x19a8ac+=_0x4a5738){_0x1044ee['push'](_0xfa7e7d['slice'](_0x19a8ac,_0x19a8ac+_0x4a5738));}let _0x5aae24=0x0,_0x4ec7a7=0x0;const _0x37e5a7=[];for(let _0x32cbf5=0x0;_0x32cbf5<_0x1044ee['length'];_0x32cbf5++){const _0x2d6bc1=_0x1044ee[_0x32cbf5];try{const _0x452b53=await models_1['default']['machineModel']['insertMany'](_0x2d6bc1,{'ordered':![],'rawResult':![]});_0x5aae24+=_0x452b53['length'];}catch(_0x246dcc){_0x246dcc?.['writeErrors']?(_0x4ec7a7+=_0x246dcc['writeErrors']['length'],_0x246dcc['writeErrors']['forEach'](_0x4cfdb5=>{_0x37e5a7['push']({'batch':_0x32cbf5+0x1,'error':_0x4cfdb5?.['errmsg'],'document':_0x4cfdb5?.['op']});})):(_0x4ec7a7+=_0x2d6bc1['length'],_0x37e5a7['push']({'batch':_0x32cbf5+0x1,'error':_0x246dcc?.['message'],'document':'entire\x20batch'}));}}return logger_1['logger']['info']('Bulk\x20operation\x20completed:\x20'+_0x5aae24+'\x20inserted,\x20'+_0x4ec7a7+'\x20errors'),{'success':!![],'totalProcessed':_0x2481dd['length'],'validRecords':_0x268dec,'savedModels':_0x5aae24,'skippedModels':_0x558546['length'],'errors':_0x4ec7a7,'errorDetails':_0x37e5a7['slice'](0x0,0xa),'skipped':_0x558546['slice'](0x0,0x64)};}catch(_0x52dd7){throw new customError_1['DatabaseError']('saveDatas\x20Error:\x20'+_0x52dd7?.['message']);}}};exports['default']=machineModelDB;