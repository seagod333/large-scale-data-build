'use strict';var __importDefault=this&&this['__importDefault']||function(_0x5f38ca){return _0x5f38ca&&_0x5f38ca['__esModule']?_0x5f38ca:{'default':_0x5f38ca};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const models_1=__importDefault(require('../models')),customError_1=require('../../@types/customError'),logger_1=require('../../utils/logger'),database_1=require('../../services/database'),machineModelDB={'create':async _0x4a7ce7=>{const _0x3890ed=new models_1['default']['machineModel'](_0x4a7ce7),_0x41c133=await _0x3890ed['save']();if(!_0x41c133)throw new customError_1['DatabaseError']('machineModelDB\x20Database\x20Error');return _0x41c133;},'findOne':async({filter:_0xa31feb})=>{return models_1['default']['machineModel']['findOne'](_0xa31feb);},'find':async({filter:_0x5401e5})=>{return models_1['default']['machineModel']['find'](_0x5401e5);},'update':async({filter:_0x4b0981,update:_0x6adc05})=>{return models_1['default']['machineModel']['findOneAndUpdate'](_0x4b0981,_0x6adc05);},'remove':async({filter:_0xbc8f36})=>{const _0x479098=await models_1['default']['machineModel']['deleteOne'](_0xbc8f36);return{'found':_0x479098['n'],'deleted':_0x479098['deletedCount']};},'saveDatas':async _0x4e9617=>{try{if(!_0x4e9617||_0x4e9617['length']===0x0)throw new customError_1['DatabaseError']('No\x20data\x20provided');logger_1['logger']['info']('Processing\x20'+_0x4e9617['length']+'\x20machine\x20model\x20records...');const _0x112b79=new Set(),_0x588bc0=await models_1['default']['machineModel']['find']({},{'machine_name':0x1,'_id':0x0});_0x588bc0['forEach'](_0x44fbd1=>{if(_0x44fbd1?.['machine_name'])_0x112b79['add'](_0x44fbd1['machine_name']);});let _0x11b6a8=await(0x0,database_1['getLastIndex'])(models_1['default']['machineModel']);const _0x3cf4ef=[],_0x39890a=[],_0x364372=new Set();let _0x3ca977=0x0;for(const _0x100b0b of _0x4e9617){const _0x4dce84=(_0x100b0b?.['machine_name']||'')['trim']();if(!_0x4dce84){_0x39890a['push']({'machine_name':'','reason':'Empty\x20machine_name'});continue;}if(_0x112b79['has'](_0x4dce84)){_0x39890a['push']({'machine_name':_0x4dce84,'reason':'Model\x20already\x20exists'});continue;}if(_0x364372['has'](_0x4dce84)){_0x39890a['push']({'machine_name':_0x4dce84,'reason':'Duplicate\x20in\x20input'});continue;}_0x3cf4ef['push']({'_id':_0x11b6a8++,'machine_name':_0x4dce84,'is_visible':0x1}),_0x364372['add'](_0x4dce84),_0x3ca977++;}const _0x3f0331=0x3e8,_0x561ef6=[];for(let _0x2a2470=0x0;_0x2a2470<_0x3cf4ef['length'];_0x2a2470+=_0x3f0331){_0x561ef6['push'](_0x3cf4ef['slice'](_0x2a2470,_0x2a2470+_0x3f0331));}let _0x1e209a=0x0,_0x5d68dd=0x0;const _0x2f4382=[];for(let _0x451b67=0x0;_0x451b67<_0x561ef6['length'];_0x451b67++){const _0x21964a=_0x561ef6[_0x451b67];try{const _0x411604=await models_1['default']['machineModel']['insertMany'](_0x21964a,{'ordered':![],'rawResult':![]});_0x1e209a+=_0x411604['length'];}catch(_0x198bd0){_0x198bd0?.['writeErrors']?(_0x5d68dd+=_0x198bd0['writeErrors']['length'],_0x198bd0['writeErrors']['forEach'](_0x79ff6b=>{_0x2f4382['push']({'batch':_0x451b67+0x1,'error':_0x79ff6b?.['errmsg'],'document':_0x79ff6b?.['op']});})):(_0x5d68dd+=_0x21964a['length'],_0x2f4382['push']({'batch':_0x451b67+0x1,'error':_0x198bd0?.['message'],'document':'entire\x20batch'}));}}return logger_1['logger']['info']('Bulk\x20operation\x20completed:\x20'+_0x1e209a+'\x20inserted,\x20'+_0x5d68dd+'\x20errors'),{'success':!![],'totalProcessed':_0x4e9617['length'],'validRecords':_0x3ca977,'savedModels':_0x1e209a,'skippedModels':_0x39890a['length'],'errors':_0x5d68dd,'errorDetails':_0x2f4382['slice'](0x0,0xa),'skipped':_0x39890a['slice'](0x0,0x64)};}catch(_0x56ce1b){throw new customError_1['DatabaseError']('saveDatas\x20Error:\x20'+_0x56ce1b?.['message']);}}};exports['default']=machineModelDB;